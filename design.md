# 仕様(ver0.3:製造間接費検討段階)
## 材料勘定(ver0.1で実装)
- 基本的発想（ver0~1）
  - 取引ごとに入力シートに記帳→月末一括処理
  - 在庫評価：移動平均法
  - 実際原価計算
  - 1種の製品を製造している
  - 当面払出額のすべてが直接費（仕掛品勘定へ）と考える
    - 仕訳との関連を持たせることができれば間接費との配賦が可能になる。

- 入力スプレッドシート列名：
  - 取引番号  入力規則: 1以上の整数
  - 日付  入力規則: 日付  ok
  - 材料コード（or 材料名）
  - 数量        （入庫：＋／払出：－）  入力規則: 0以外の数
  - 単価        （※入庫時のみ入力、払出時は空白）
  - 金額        （自動計算：数量×単価 ※入庫行のみ）
  - 摘要

- gasの役割
  - GASで：
    - 在庫数量を累積
    - 移動平均単価を内部計算
    - 払出原価を算出
    - 材料費合計を集計

- 在庫数・在庫価格は出力シートで表示
  - 入力シート：事実のみ
  - 集計シート:ver0.1では仕掛品勘定へ全額（直接費扱い）：T勘定要素を材料名ごとに集計。以下のそれぞれについて数量と金額を表示
    - 前月繰越（当面スクリプト内で直接指定。今後期を跨ぐ際の処理を実装予定。）
    - 当月受入
    - 当月払出
    - 翌月繰越

## 労務費勘定(ver0.2で実装)
- 基本的発想(ver0~1)
  - 勤怠簿から確定済月間勤怠が共有されている想定
  - 従業員に紐づいた時給が勤怠シート側で計算できる想定
  - 実際原価計算・1財生産（材料費と同じ）
  - 作業内容に製造/手待の区別を導入し、直接費用と間接費用に区別
  - 実務において作業時間は所与でないことを意識（簿記の教科書との違い）
- 入力スプレッドシート列名：
  - 日付：日付以外入らないよう統制
  - 職員氏名：プルダウンで入力
  - 作業時間：上限勤務時間内の数値
  - 作業内容：プルダウンで入力
  - 時給：作業員名と紐づけて自動入力
  - 金額：自動計算
- GASでの処理
  - 入力内容を1行ごとに走査
  - 作業内容が製造なら直接費用、手待なら間接費用に割り振って月間集計
    - 未払賃金を設計に入れていない理由：
      - 本ツールは原価計算を目的としており、勤怠が確定した時点で当月発生額を確定させる設計としているため。
- 出力
  - 当月直接労務費
  - 当月製造間接費振替

## 製造間接費(ver0.3で実装予定)検討
- 基本的発想(ver0~1)
  - 間接費っぽいものを一旦全部集め、月次で確定させる箱
  - 入力:間接労務費（後で間接経費を追加予定）
  - 処理:一財想定の間は集計のみ。（v2以降で2財以上製造するときに部門別集計、配賦等を導入予定）
  - 出力:仕掛品勘定へ
  - 検討:
    - v1では集計くらいしかすることがなく、かつ自分で入力することもほぼないが、v2以降で発展する予定
    - v1で入力を各シート（労務費、経費）から取ってくるのを製造間接費担当の仕事にするよりも、各シート入力が終わったら製造間接費入力シートに転記される方がよい
      - 確定、修正などあるかもしれないが、とりあえずその月の労務費（、経費）の集計・仕訳が終わったらメール通知があった方が無難？
      - とりあえずlabor.gsが集計されたら製造間接費の入力シートに飛ばす、製造間接費担当者にメールを送る
    - 製造間接費担当者はメール確認後に集計ボタン→仕掛品勘定へ飛ばす＋仕掛品担当者（いるのか？）にメール送信して仕掛品勘定へ
      - 材料費の方も仕掛品勘定に飛ばす仕組みを追加する必要がある。
